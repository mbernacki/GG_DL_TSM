# README

## Data Source and Organization
The raw data used in this project is generated by the **ToRealMotion** high-fidelity code and stored in the `trm/` directory.  
After preprocessing with `1_preprocessed_to_bins.py`, the transformed data (30-bin distributions each time step) is saved in the `trm2/` directory. These preprocessed files are then used by `main_code.py` during model training.

---

## Project Structure

```
code/
├─ 1_preprocessed_to_bins.py
│    ├─ Analyzes the raw files containing GrainSize values
│    ├─ Converts each raw file into a discrete distribution composed of 30 bins
│    ├─ Ensures consistent format and structure across all time steps in each sequence
│    └─ Produces preprocessed .txt files to be used by main_code.py
│
├─ main_code.py
│    ├─ Loads and normalizes the preprocessed sequences
│    ├─ Generates the datasets (train / validation / test)
│    ├─ Trains several Deep Learning models:
│    │      → RNN  
│    │      → LSTM  
│    │      → TCN  
│    │      → Transformer
│    ├─ Performs autoregressive predictions over multiple time steps
│    ├─ Denormalizes model outputs back to original scale
│    ├─ Evaluates performance using:
│    │      → MAE  
│    │      → MSE  
│    │      → RMSE  
│    │      → MRE
│    └─ Saves the trained models and generated figures
│
├─ trm/
│  
│    ├─ Data transformed into 30-bin distributions (trm folder)
│    └─ test_sequences
│   
│
├─ models/
│      → Trained models (.keras)
│
└─ output/
       ├─ Training and validation loss curves
       ├─ Comparison plots between models
       └─ Denormalized prediction results
```

---

## Usage

### **1) Data Preprocessing**
```bash
python3 1_preprocessed_to_bins.py
```

### **2) Training and Prediction**
```bash
python3 main_code.py
```

